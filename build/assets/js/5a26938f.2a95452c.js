(self.webpackChunkpypesa=self.webpackChunkpypesa||[]).push([[579],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return p},kt:function(){return m}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=r.createContext({}),u=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=u(e.components);return r.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},l=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,c=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),l=u(n),m=a,y=l["".concat(c,".").concat(m)]||l[m]||d[m]||i;return n?r.createElement(y,o(o({ref:t},p),{},{components:n})):r.createElement(y,o({ref:t},p))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=l;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var u=2;u<i;u++)o[u]=n[u];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}l.displayName="MDXCreateElement"},8414:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return s},metadata:function(){return c},toc:function(){return u},default:function(){return d}});var r=n(2122),a=n(9756),i=(n(7294),n(3905)),o=["components"],s={sidebar_position:8},c={unversionedId:"direct_debit",id:"direct_debit",isDocsHomePage:!1,title:"Direct debit creation and Payment",description:"Direct Debits are payments in M-Pesa that are initiated by the Payee alone without any Payer interaction, but permission must first be granted by the Payer. The granted permission from the Payer to Payee is commonly termed a \u2018Mandate\u2019, and M-Pesa must hold details of this Mandate.",source:"@site/docs/direct_debit.md",sourceDirName:".",slug:"/direct_debit",permalink:"/pypesa/docs/direct_debit",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/direct_debit.md",version:"current",sidebarPosition:8,frontMatter:{sidebar_position:8},sidebar:"tutorialSidebar",previous:{title:"Transaction status",permalink:"/pypesa/docs/transaction_status"},next:{title:"Deployment to Production",permalink:"/pypesa/docs/deployment"}},u=[{value:"Direct debit Creation",id:"direct-debit-creation",children:[]},{value:"Direct Debit Payment",id:"direct-debit-payment",children:[]}],p={toc:u};function d(e){var t=e.components,n=(0,a.Z)(e,o);return(0,i.kt)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Direct Debits are payments in M-Pesa that are initiated by the Payee alone without any Payer interaction, but permission must first be granted by the Payer. The granted permission from the Payer to Payee is commonly termed a \u2018Mandate\u2019, and M-Pesa must hold details of this Mandate."),(0,i.kt)("p",null,"The Direct Debit API set allows an organisation to get the initial consent of their customers to create the Mandate that allows the organisation to debit customer's account at an agreed frequency and amount for services rendered. After the initial consent, the debit of the account will not involve any customer interaction."),(0,i.kt)("p",null,"The Direct Debit feature makes use of the following API calls:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Create a Direct Debit mandate"),(0,i.kt)("li",{parentName:"ul"},"Pay a mandate")),(0,i.kt)("p",null,"The customer is able to view and cancel the Direct Debit mandate from G2 menu accessible via USSD menu or the Smartphone Application."),(0,i.kt)("h2",{id:"direct-debit-creation"},"Direct debit Creation"),(0,i.kt)("p",null,"Use ",(0,i.kt)("em",{parentName:"p"},"create_direct_debit()")," method to create one in Pypesa as shown in the example below;"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},'>> import pypesa\n>> mpesa = pypesa()\n>> transaction_query = {\n      "input_AgreedTC": "1",\n      "input_Country": "TZN",\n      "input_CustomerMSISDN": "000000000001",\n      "input_EndRangeOfDays": "22",\n      "input_ExpiryDate": "20211126",\n      "input_FirstPaymentDate": "20160324",\n      "input_Frequency": "06",\n      "input_ServiceProviderCode": "000000",\n      "input_StartRangeOfDays": "01",\n      "input_ThirdPartyConversationID": "5334a912jbsj1j2kk1",\n      "input_ThirdPartyReference": "3333",\n    }\n>> mpesa.create_direct_debit(transaction_query)\n\n{\'output_ResponseCode\': \'INS-0\', \'output_ResponseDesc\': \'Request processed successfully\', \'output_TransactionReference\': \'3333\', \'output_ConversationID\': \'8eedbfb665284bdc9e5c548fa96e996a\', \'output_ThirdPartyConversationID\': \'5334a912jbsj1j2kk1\'}\n\n')),(0,i.kt)("h2",{id:"direct-debit-payment"},"Direct Debit Payment"),(0,i.kt)("p",null,"Here an Pypesa example on how how you can do direct Debit Payment in Pypesa using the ",(0,i.kt)("em",{parentName:"p"},"direct debit payment()"),";"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},'>> import pypesa\n>> mpesa = pypesa()\n>> transaction_query = {        \n      "input_Amount": "10",\n      "input_Country": "TZN",\n      "input_Currency": "TZS",\n      "input_CustomerMSISDN": "000000000001",\n      "input_ServiceProviderCode": "000000",\n      "input_ThirdPartyConversationID": "v2de053v4912jbasdj1j2kk",\n      "input_ThirdPartyReference": "5db410b459bd433ca8e5"\n    }\n>> mpesa.direct_debit_payment(transaction_query)\n{\'output_ResponseCode\': \'INS-0\', \'output_ResponseDesc\': \'Request processed successfully\', \'output_TransactionID\': \'js38ecMBpNoF\', \'output_ConversationID\': \'263f515f8d464408b764b0f1bdbc0105\', \'output_ThirdPartyConversationID\': \'v2de053v4912jbasdj1j2kk\'}\n\n')))}d.isMDXComponent=!0}}]);